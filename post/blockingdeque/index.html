<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>BlockingDeque</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="BlockingDeque åŒç«¯é˜Ÿåˆ—ï¼Œæ”¯æŒåœ¨é˜Ÿåˆ—çš„å¤´å°¾å‡ºå¢åŠ æˆ–è·å–æ•°æ®ï¼ŒDequeæ¥å£ä¸­å®šä¹‰äº†ç›¸å…³çš„æ–¹æ³•
public interface Deque&amp;lt;E&amp;gt; extends Queue&amp;lt;E&amp;gt; { // æ·»åŠ åˆ°é˜Ÿé¦–  void addFirst(E e); // æ·»åŠ åˆ°é˜Ÿå°¾  void addLast(E e); // è·å–é˜Ÿé¦–  boolean offerFirst(E e); // è·å–é˜Ÿå°¾  boolean offerLast(E e); ... }	 ç›¸æ¯”BlockingQueueçš„çˆ¶æ¥å£Queueï¼ŒDequeä¸­å®šä¹‰äº†å¤´å°¾æ“ä½œæ•°æ®çš„æ–¹æ³•ã€‚
 public interface BlockingDeque&amp;lt;E&amp;gt; extends BlockingQueue&amp;lt;E&amp;gt;, Deque&amp;lt;E&amp;gt; { void putFirst(E e) throws InterruptedException; void putLast(E e) throws InterruptedException; E takeFirst() throws InterruptedException; E takeLast() throws InterruptedException; ... }  BlockingQueueç»§æ‰¿äº†BlockingQueueå’ŒDequeæ¥å£ã€‚æ·»åŠ äº†ä¸€äº›æŠ›å‡ºä¸­æ–­çš„æ–¹æ³•ã€‚
  LinkedBlockingDeque æˆ‘ä»¬ä»¥LinkedBlockingDequeä¸ºåˆ‡å…¥ç‚¹äº†è§£åŒç«¯é˜Ÿåˆ—çš„å®ç°ã€‚"/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<meta name="google-site-verification" content="e1ELBPEvOV5kwQNtzaLcNt-3iZy83eiNhSZkHhQPecs" />
<meta name="baidu-site-verification" content="aNoX6MUEHW" />
<link rel="canonical" href="https://www.leejay.top/post/blockingdeque/" />

<script type="text/javascript"
        async
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
        >
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] },
    'HTML-CSS': {
        showMathMenu: false 
    }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>




<link rel="stylesheet" href="https://www.leejay.top/assets/style.css">




<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.leejay.top/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://www.leejay.top/img/favicon.png">



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BlockingDeque"/>
<meta name="twitter:description" content="åŸºäºReentrantLockã€Conditionå®ç°çš„`åŒç«¯é˜»å¡é˜Ÿåˆ—`ï¼Œæ”¯æŒåœ¨é˜Ÿé¦–å’Œé˜Ÿå°¾è·å–/æ·»åŠ æ•°æ®ã€‚"/>



<meta property="og:title" content="BlockingDeque" />
<meta property="og:description" content="åŸºäºReentrantLockã€Conditionå®ç°çš„`åŒç«¯é˜»å¡é˜Ÿåˆ—`ï¼Œæ”¯æŒåœ¨é˜Ÿé¦–å’Œé˜Ÿå°¾è·å–/æ·»åŠ æ•°æ®ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.leejay.top/post/blockingdeque/" />
<meta property="article:published_time" content="2020-07-06T19:20:56+08:00" />
<meta property="article:modified_time" content="2020-07-06T19:20:56+08:00" /><meta property="og:site_name" content="Aurora" />






  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="https://www.leejay.top" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="https://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg></span>
    <span class="logo__text">Aurora</span>
    <span class="logo__cursor"></span>
    <span class="logo__cursor2"></span>
  
</a>
    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/categories">Categories</a></li>
        
      
        
          <li><a href="/tags">Tags</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/categories">Categories</a></li>
      
    
      
        <li><a href="/tags">Tags</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="https://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://www.leejay.top/post/blockingdeque/">BlockingDeque</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2020-07-06
        </span>

        
          
        
      

      
      
    </div>

    
      <span class="post-tags">
        
        ğŸ–<a href="https://www.leejay.top/tags/blockingdeque/">BlockingDeque </a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      <h3 id="blockingdeque">BlockingDeque</h3>
<p><code>åŒç«¯é˜Ÿåˆ—ï¼Œæ”¯æŒåœ¨é˜Ÿåˆ—çš„å¤´å°¾å‡ºå¢åŠ æˆ–è·å–æ•°æ®</code>ï¼Œ<code>Deque</code>æ¥å£ä¸­å®šä¹‰äº†ç›¸å…³çš„æ–¹æ³•</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Deque</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Queue<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// æ·»åŠ åˆ°é˜Ÿé¦–
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addFirst</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">);</span>
    <span style="color:#75715e">// æ·»åŠ åˆ°é˜Ÿå°¾
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addLast</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">);</span>
    <span style="color:#75715e">// è·å–é˜Ÿé¦–
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">offerFirst</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">);</span>
    <span style="color:#75715e">// è·å–é˜Ÿå°¾
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">offerLast</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">);</span>
	<span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>	
</code></pre></div><blockquote>
<p>ç›¸æ¯”<code>BlockingQueueçš„çˆ¶æ¥å£Queue</code>ï¼Œ<code>Deque</code>ä¸­å®šä¹‰äº†å¤´å°¾æ“ä½œæ•°æ®çš„æ–¹æ³•ã€‚</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">BlockingDeque</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> BlockingQueue<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;,</span> Deque<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">putFirst</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> InterruptedException<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">putLast</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> InterruptedException<span style="color:#f92672">;</span>
    E <span style="color:#a6e22e">takeFirst</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> InterruptedException<span style="color:#f92672">;</span>
    E <span style="color:#a6e22e">takeLast</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> InterruptedException<span style="color:#f92672">;</span>
   <span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<p><code>BlockingQueue</code>ç»§æ‰¿äº†<code>BlockingQueue</code>å’Œ<code>Deque</code>æ¥å£ã€‚æ·»åŠ äº†ä¸€äº›æŠ›å‡ºä¸­æ–­çš„æ–¹æ³•ã€‚</p>
</blockquote>
<hr>
<h3 id="linkedblockingdeque">LinkedBlockingDeque</h3>
<p>æˆ‘ä»¬ä»¥<code>LinkedBlockingDeque</code>ä¸ºåˆ‡å…¥ç‚¹äº†è§£<code>åŒç«¯é˜Ÿåˆ—</code>çš„å®ç°ã€‚</p>
<h4 id="æ„é€ ">æ„é€ </h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LinkedBlockingDeque</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span>
    <span style="color:#66d9ef">extends</span> AbstractQueue<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span>
    <span style="color:#66d9ef">implements</span> BlockingDeque<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;,</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">io</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Serializable</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// å†…éƒ¨ç»´æŠ¤çš„é™æ€å†…éƒ¨ç±»æ˜¯åŒå‘èŠ‚ç‚¹
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Node</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
        E item<span style="color:#f92672">;</span>
        Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> prev<span style="color:#f92672">;</span><span style="color:#75715e">// åŒºåˆ«
</span><span style="color:#75715e"></span>        Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> next<span style="color:#f92672">;</span>
        Node<span style="color:#f92672">(</span>E x<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            item <span style="color:#f92672">=</span> x<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#75715e">// (first == null &amp;&amp; last == null) || 
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// (first.prev == null &amp;&amp; first.item != null) è§„åˆ™ä¸å˜
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">transient</span> Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> first<span style="color:#f92672">;</span>
    <span style="color:#75715e">// (first == null &amp;&amp; last == null) ||
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// (last.next == null &amp;&amp; last.item != null) è§„åˆ™ä¸å˜
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">transient</span> Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> last<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">transient</span> <span style="color:#66d9ef">int</span> count<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> capacity<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å†…éƒ¨ä»æ˜¯ä¸€æŠŠé” ä¸¤ä¸ªæ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">final</span> ReentrantLock lock <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ReentrantLock<span style="color:#f92672">();</span>
    <span style="color:#75715e">// ç­‰å¾…è·å– æ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Condition notEmpty <span style="color:#f92672">=</span> lock<span style="color:#f92672">.</span><span style="color:#a6e22e">newCondition</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">// ç­‰å¾…æ·»åŠ   æ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Condition notFull <span style="color:#f92672">=</span> lock<span style="color:#f92672">.</span><span style="color:#a6e22e">newCondition</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">LinkedBlockingDeque</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MAX_VALUE</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">LinkedBlockingDeque</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> capacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>capacity <span style="color:#f92672">&lt;=</span> 0<span style="color:#f92672">)</span> <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException<span style="color:#f92672">();</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">capacity</span> <span style="color:#f92672">=</span> capacity<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<p>ä¸<code>LinkedBlockingQueue</code>æ„é€ åŒºåˆ«ï¼š</p>
<ol>
<li><code>å†…éƒ¨ç»´æŠ¤æ˜¯åŒé“¾è¡¨èŠ‚ç‚¹ï¼Œæ‹¥æœ‰prevå’ŒnextæŒ‡é’ˆ</code>ã€‚</li>
<li>é˜Ÿåˆ—åˆå§‹åŒ–åï¼Œfirstå’ŒlastèŠ‚ç‚¹çš„item != nullï¼Œ</li>
</ol>
</blockquote>
<hr>
<h3 id="æ·»åŠ ">æ·»åŠ </h3>
<h4 id="putfirst">putFirst</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// æ·»åŠ å…ƒç´ åˆ°é˜Ÿé¦–ï¼Œé˜Ÿåˆ—æ»¡å°±é˜»å¡ç­‰å¾…
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">putFirst</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> InterruptedException <span style="color:#f92672">{</span>
    <span style="color:#75715e">// åˆ¤æ–­æ˜¯å¦ä¸ºnull
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>e <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NullPointerException<span style="color:#f92672">();</span>
    <span style="color:#75715e">// å°è£…èŠ‚ç‚¹
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> node <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;(</span>e<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">final</span> ReentrantLock lock <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è¿™é‡Œæ˜¯lockä¸æ˜¯lockInterruptibly
</span><span style="color:#75715e"></span>    lock<span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// å¦‚æœé˜Ÿåˆ—æ»¡è¿”å›false
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span>linkFirst<span style="color:#f92672">(</span>node<span style="color:#f92672">))</span>
            <span style="color:#75715e">// å°†çº¿ç¨‹åŠ å…¥ ç­‰å¾…æ·»åŠ æ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>            notFull<span style="color:#f92672">.</span><span style="color:#a6e22e">await</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
        lock<span style="color:#f92672">.</span><span style="color:#a6e22e">unlock</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">// å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿé¦–ï¼Œé˜Ÿåˆ—æ»¡è¿”å›false
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">linkFirst</span><span style="color:#f92672">(</span>Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> node<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// é˜Ÿåˆ—æ»¡è¿”å›false
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>count <span style="color:#f92672">&gt;=</span> capacity<span style="color:#f92672">)</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–firstèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> f <span style="color:#f92672">=</span> first<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†å½“å‰èŠ‚ç‚¹çš„nextæŒ‡å‘first
</span><span style="color:#75715e"></span>    node<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> f<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†nodeè®¾ä¸ºfirst
</span><span style="color:#75715e"></span>    first <span style="color:#f92672">=</span> node<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å¦‚æœlast=nullï¼Œè¯´æ˜å½“å‰æ˜¯ç¬¬ä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—çš„èŠ‚ç‚¹
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>last <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#75715e">// first = last = Node(prev=null, next=null, item != null)
</span><span style="color:#75715e"></span>        last <span style="color:#f92672">=</span> node<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e">// last != null ç»´æŠ¤ nodeå’Œfirstçš„prevå’Œnextï¼Œä¸å¤„ç†last
</span><span style="color:#75715e"></span>        f<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> node<span style="color:#f92672">;</span>
    <span style="color:#75715e">// é˜Ÿåˆ—å¤§å°+1
</span><span style="color:#75715e"></span>    <span style="color:#f92672">++</span>count<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å”¤é†’ç­‰å¾…è·å–æ¡ä»¶é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹
</span><span style="color:#75715e"></span>    notEmpty<span style="color:#f92672">.</span><span style="color:#a6e22e">signal</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">// è¿”å›true
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<ol>
<li>å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿé¦–ï¼Œå¦‚æœé˜Ÿåˆ—æ»¡ï¼Œ<code>é˜»å¡</code>ç­‰å¾…ç›´åˆ°å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚</li>
<li>å½“æ·»åŠ èŠ‚ç‚¹æ˜¯é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œ<code>first = last = Node(prev = next = null, item != null)</code>ï¼Œä¹‹å<code>linkFirst</code>å°±åªä¼šç»´æŠ¤nodeå’Œfistä¹‹é—´çš„å…³ç³»ï¼Œä¸ä¼šç»´æŠ¤lastèŠ‚ç‚¹ã€‚</li>
</ol>
</blockquote>
<h4 id="putlast">putLast</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿå°¾
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">putLast</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> InterruptedException <span style="color:#f92672">{</span>
    <span style="color:#75715e">// åˆ¤æ–­NPE
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>e <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NullPointerException<span style="color:#f92672">();</span>
    <span style="color:#75715e">// åˆ›å»ºèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> node <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;(</span>e<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">final</span> ReentrantLock lock <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">;</span>
    lock<span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// å°†å…ƒç´ åŠ å…¥é˜Ÿå°¾ï¼Œå¦‚æœé˜Ÿåˆ—æ»¡è¿”å›false
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span>linkLast<span style="color:#f92672">(</span>node<span style="color:#f92672">))</span>
            <span style="color:#75715e">// å°†çº¿ç¨‹åŠ å…¥ ç­‰å¾…æ·»åŠ æ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>            notFull<span style="color:#f92672">.</span><span style="color:#a6e22e">await</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
        lock<span style="color:#f92672">.</span><span style="color:#a6e22e">unlock</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">// å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿå°¾ï¼Œé˜Ÿåˆ—æ»¡è¿”å›false
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">linkLast</span><span style="color:#f92672">(</span>Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> node<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// å¦‚æœé˜Ÿåˆ—æ»¡è¿”å›false
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>count <span style="color:#f92672">&gt;=</span> capacity<span style="color:#f92672">)</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–lastèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> l <span style="color:#f92672">=</span> last<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†nodeçš„å‰é©±è®¾ä¸ºlast
</span><span style="color:#75715e"></span>    node<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> l<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†nodeè®¾ä¸ºlast
</span><span style="color:#75715e"></span>    last <span style="color:#f92672">=</span> node<span style="color:#f92672">;</span>
    <span style="color:#75715e">// åŒç†ï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹ç¬¬ä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—çš„èŠ‚ç‚¹
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>first <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#75715e">// first = last = node(prev=null, last=null, item!=null)
</span><span style="color:#75715e"></span>        first <span style="color:#f92672">=</span> node<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e">// ä¸æ˜¯ç¬¬ä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—çš„èŠ‚ç‚¹ï¼Œç»´æŠ¤lastå’Œnodeä¹‹é—´çš„å…³ç³»
</span><span style="color:#75715e"></span>        l<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> node<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†é˜Ÿåˆ—æ•°é‡åŠ 1
</span><span style="color:#75715e"></span>    <span style="color:#f92672">++</span>count<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å”¤é†’ ç­‰å¾…è·å–æ¡ä»¶é˜Ÿåˆ—çº¿ç¨‹
</span><span style="color:#75715e"></span>    notEmpty<span style="color:#f92672">.</span><span style="color:#a6e22e">signal</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<ol>
<li>å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿå°¾ï¼Œå¦‚æœé˜Ÿåˆ—æ»¡ï¼Œ<code>é˜»å¡</code>ç­‰å¾…ç›´åˆ°å°†å…ƒç´ æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚</li>
<li>å’Œ<code>putFirst</code>åŒç†ï¼Œç¬¬ä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—çš„èŠ‚ç‚¹éœ€è¦ç‰¹æ®Šå¤„ç†ä¸‹ï¼Œ<code>linkLast</code>åªä¼šç»´æŠ¤nodeå’Œlastä¹‹é—´çš„å…³ç³»ï¼Œä¸ä¼šç»´æŠ¤firstèŠ‚ç‚¹ã€‚</li>
</ol>
</blockquote>
<h3 id="è·å–">è·å–</h3>
<h4 id="takefirst">takeFirst</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// è·å–é˜Ÿé¦–å…ƒç´ 
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> E <span style="color:#a6e22e">takeFirst</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> InterruptedException <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">final</span> ReentrantLock lock <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–ç‹¬å é”
</span><span style="color:#75715e"></span>    lock<span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        E x<span style="color:#f92672">;</span>
        <span style="color:#75715e">// é˜Ÿåˆ—ä¸ºç©ºè¿”å›falseï¼Œå°±é˜»å¡ç­‰å¾…æ‹¿åˆ°å¤´å…ƒç´ 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span> <span style="color:#f92672">(</span>x <span style="color:#f92672">=</span> unlinkFirst<span style="color:#f92672">())</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
            <span style="color:#75715e">// å°†çº¿ç¨‹åŠ å…¥ ç­‰å¾…è·å–æ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>            notEmpty<span style="color:#f92672">.</span><span style="color:#a6e22e">await</span><span style="color:#f92672">();</span>
        <span style="color:#75715e">// å¦åˆ™è¿”å›å…ƒç´ 
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> x<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
        lock<span style="color:#f92672">.</span><span style="color:#a6e22e">unlock</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">// é˜Ÿåˆ—ä¸ºç©ºè¿”å›nullï¼Œå¦åˆ™è¿”å›å¤´èŠ‚ç‚¹å¹¶å¤„ç†é“¾è¡¨
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> E <span style="color:#a6e22e">unlinkFirst</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">/// è‹¥first = nullï¼Œè¯´æ˜é˜Ÿåˆ—æ²¡æœ‰åˆå§‹åŒ–ï¼Œç›´æ¥è¿”å›null
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> f <span style="color:#f92672">=</span> first<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>f <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–firstçš„nextèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> n <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–nextèŠ‚ç‚¹çš„item
</span><span style="color:#75715e"></span>    E item <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span><span style="color:#a6e22e">item</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†first.item = null
</span><span style="color:#75715e"></span>    f<span style="color:#f92672">.</span><span style="color:#a6e22e">item</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// å»æ‰fçš„å¼•ç”¨ï¼Œä¾¿äºGC
</span><span style="color:#75715e"></span>    f<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> f<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†nextèŠ‚ç‚¹è®¾ä¸ºfirstèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    first <span style="color:#f92672">=</span> n<span style="color:#f92672">;</span>
    <span style="color:#75715e">// æˆç«‹æ¡ä»¶ï¼š1. é˜Ÿåˆ—åˆšåˆå§‹åŒ–è¿˜æ²¡æœ‰èŠ‚ç‚¹è¿›å…¥ 2. èŠ‚ç‚¹è¢«æ¸…ç©ºäº†ã€‚
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// ä¸¤ä¸ªæ¡ä»¶éƒ½éœ€è¦å¤„ç†ä¸‹lastèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#75715e">// first = last = null
</span><span style="color:#75715e"></span>        last <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e">// å¦‚æœé˜Ÿåˆ—ä¸­è¿˜æœ‰å…¶ä»–å…ƒç´ ï¼Œä¸å¤„ç†lastï¼Œå°†first.prev=null
</span><span style="color:#75715e"></span>        n<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// å°†é˜Ÿåˆ—å¤§å°-1
</span><span style="color:#75715e"></span>    <span style="color:#f92672">--</span>count<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å”¤é†’ç­‰å¾…æ·»åŠ é˜Ÿåˆ—ä¸­çº¿ç¨‹
</span><span style="color:#75715e"></span>    notFull<span style="color:#f92672">.</span><span style="color:#a6e22e">signal</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">return</span> item<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<ol>
<li>takeFirstä¼šè·å–é˜Ÿé¦–å…ƒç´ ï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œ<code>é˜»å¡</code>ç­‰å¾…ç›´åˆ°é˜Ÿåˆ—ä¸ä¸ºç©ºè·å–åˆ°å…ƒç´ ã€‚</li>
<li>è·å–é˜Ÿé¦–å…ƒç´ çš„åŒæ—¶ï¼Œä¼šåˆ é™¤åŸæ¥çš„firstçš„èŠ‚ç‚¹ã€‚å¦‚æœ<code>åˆ é™¤åé˜Ÿåˆ—æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹æˆ–é˜Ÿåˆ—åˆšåˆå§‹åŒ–</code>ï¼Œéƒ½éœ€è¦å¤„ç†lastèŠ‚ç‚¹ã€‚å¦åˆ™åªéœ€è¦ç»´æŠ¤firstèŠ‚ç‚¹ï¼Œä¸ç”¨å¤„ç†lastèŠ‚ç‚¹ã€‚</li>
</ol>
</blockquote>
<h4 id="takelast">takeLast</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> E <span style="color:#a6e22e">takeLast</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> InterruptedException <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">final</span> ReentrantLock lock <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">;</span>
    lock<span style="color:#f92672">.</span><span style="color:#a6e22e">lock</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        E x<span style="color:#f92672">;</span>
        <span style="color:#75715e">// é˜Ÿåˆ—ä¸ºç©ºè¿”å›nullï¼Œä¼šåŠ å…¥ç­‰å¾…è·å–æ¡ä»¶é˜Ÿåˆ—
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span> <span style="color:#f92672">(</span>x <span style="color:#f92672">=</span> unlinkLast<span style="color:#f92672">())</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
            notEmpty<span style="color:#f92672">.</span><span style="color:#a6e22e">await</span><span style="color:#f92672">();</span>
        <span style="color:#66d9ef">return</span> x<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
        lock<span style="color:#f92672">.</span><span style="color:#a6e22e">unlock</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">// é˜Ÿåˆ—ä¸ºç©ºè¿”å›nullï¼Œå¦åˆ™è¿”å›lastèŠ‚ç‚¹
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> E <span style="color:#a6e22e">unlinkLast</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// å¦‚æœlast = nullé‚£ä¹ˆè¯´æ˜é˜Ÿåˆ—ä¸ºç©ºï¼ˆæˆ–è¢«æ¸…ç©ºäº†ï¼‰ï¼Œè¿”å›null
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> l <span style="color:#f92672">=</span> last<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>l <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–lastçš„å‰é©±èŠ‚ç‚¹
</span><span style="color:#75715e"></span>    Node<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> p <span style="color:#f92672">=</span> l<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// è·å–å‰é©±èŠ‚ç‚¹çš„itemï¼Œå¹¶è®¾ä¸ºnull
</span><span style="color:#75715e"></span>    E item <span style="color:#f92672">=</span> l<span style="color:#f92672">.</span><span style="color:#a6e22e">item</span><span style="color:#f92672">;</span>
    l<span style="color:#f92672">.</span><span style="color:#a6e22e">item</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// å»é™¤lastèŠ‚ç‚¹å¼•ç”¨ï¼Œä¾¿äºå›æ”¶
</span><span style="color:#75715e"></span>    l<span style="color:#f92672">.</span><span style="color:#a6e22e">prev</span> <span style="color:#f92672">=</span> l<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å‰é©±èŠ‚ç‚¹è®¾ä¸ºlast
</span><span style="color:#75715e"></span>    last <span style="color:#f92672">=</span> p<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å’ŒtakeFirstä¸€è‡´ï¼Œå¤„ç†é˜Ÿåˆ—è¢«æ¸…ç©ºæˆ–åˆšåˆå§‹åŒ–æ—¶firstèŠ‚ç‚¹
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>p <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
        first <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">else</span>
        <span style="color:#75715e">// ä¸éœ€è¦å¤„ç†firstèŠ‚ç‚¹ï¼Œç»´æŠ¤nodeå’Œlastå…³ç³»
</span><span style="color:#75715e"></span>        p<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// é˜Ÿåˆ—å¤§å°-1
</span><span style="color:#75715e"></span>    <span style="color:#f92672">--</span>count<span style="color:#f92672">;</span>
    <span style="color:#75715e">// å”¤é†’ ç­‰å¾…æ·»åŠ æ¡ä»¶é˜Ÿåˆ—çº¿ç¨‹
</span><span style="color:#75715e"></span>    notFull<span style="color:#f92672">.</span><span style="color:#a6e22e">signal</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">return</span> item<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<ol>
<li>takeLastä¼šè·å–é˜Ÿå°¾å…ƒç´ ï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œ<code>é˜»å¡</code>ç­‰å¾…ç›´åˆ°é˜Ÿåˆ—ä¸ä¸ºç©ºè·å–åˆ°å…ƒç´ ã€‚</li>
<li>è·å–é˜Ÿå°¾å…ƒç´ çš„åŒæ—¶ï¼Œä¼šåˆ é™¤åŸæ¥çš„lastçš„èŠ‚ç‚¹ã€‚å¦‚æœ<code>åˆ é™¤åé˜Ÿåˆ—æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹æˆ–é˜Ÿåˆ—åˆšåˆå§‹åŒ–</code>ï¼Œéƒ½éœ€è¦å¤„ç†firstèŠ‚ç‚¹ã€‚å¦åˆ™åªéœ€è¦ç»´æŠ¤lastèŠ‚ç‚¹ï¼Œä¸ç”¨å¤„ç†firstèŠ‚ç‚¹ã€‚</li>
</ol>
</blockquote>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<ul>
<li>é™¤äº†å†…éƒ¨ç»´æŠ¤çš„æ˜¯<code>åŒå‘é“¾è¡¨é˜Ÿåˆ—ã€ä¸€æŠŠç‹¬å é”å’Œä¸¤ä¸ªæ¡ä»¶é˜Ÿåˆ—</code>å¤–ï¼Œå…¶å®ç°åŸç†å’Œ<code>LinkedBlockingQueue</code>ç›¸åŒã€‚</li>
<li><code>LinkedBlockingDeque</code>æ— è®ºæ“ä½œé˜Ÿé¦–è¿˜æ˜¯é˜Ÿå°¾ï¼Œéƒ½è¦è€ƒè™‘<code>é˜Ÿåˆ—å†…æ— èŠ‚ç‚¹</code>çš„æƒ…å†µã€‚</li>
<li><code>LinkedBlockingDeque</code>ä¸­éç©ºé˜Ÿåˆ—æ˜¯ä¸å­˜åœ¨å“¨å…µèŠ‚ç‚¹çš„ï¼Œæ˜¯<code>ç›´æ¥è¿”å›å¤´æˆ–å°¾</code>ï¼Œè€Œ<code>LinkedBlockingQueue</code>è¿”å›çš„æ˜¯<code>å¤´èŠ‚ç‚¹çš„nextèŠ‚ç‚¹</code>ã€‚</li>
<li>å› ä¸º<code>ä¸€æŠŠé”çš„è®¾è®¡ï¼Œå­˜åœ¨å¤´å°¾æ“ä½œéƒ½éœ€è¦ç«äº‰é”</code>çš„é—®é¢˜ï¼Œæ‰€ä»¥<code>LinkedBlockingDeque</code>æ•ˆç‡è¦ä½äº<code>LinkedBlockingQueue</code>ã€‚</li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">å…¶ä»–æ–‡ç« </span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://www.leejay.top/post/copyonwritearraylist/">
                  <span class="button__icon">â†</span>
                  <span class="button__text">CopyOnWriteArrayList</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://www.leejay.top/post/blockingqueue/">
                  <span class="button__text">BlockingQueue</span>
                  <span class="button__icon">â†’</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        

      
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">è‹ICPå¤‡18050258å·-1</div>
    
  </div>
</footer>

<script src="https://www.leejay.top/assets/main.js"></script>
<script src="https://www.leejay.top/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
